apiVersion: qlik.com/v1
kind: SelectivePatch
metadata:
  name: sharing-component-secrets
enabled: true
patches:
- target:
    kind: SuperSecret
  patch: |-
    apiVersion: qlik.com/v1
    kind: SuperSecret
    metadata:
      name: sharing-secrets
    stringData:
        tokenAuthPrivateKeyId: (( (ds "data").kid ))
        tokenAuthPrivateKey: |
          ((- "\n"))(( (ds "data").private_key | indent 8 ))
        redisPassword: "NGkUp0VDJtc3xiyC"   
- target:
    kind: Secret
  patch: |-
    - op: add
      path: /stringData
      value:
        mongoDbUri: mongodb://$(PREFIX)-mongodb:27017/sharing
