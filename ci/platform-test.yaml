apiVersion: v1
kind: Pod
metadata:
  name: platform-test
  labels:
    purpose: run-platform-test
spec:
  imagePullSecrets:
    - name: artifactory-docker-infrastructure-secret
  volumes:
    - name: platform-test-pvc
      persistentVolumeClaim:
        claimName: platform-test-pvc
  containers:
    - name: platform-test-gauge
      image: qliktech-docker-infrastructure.jfrog.io/platformtest-gauge:latest
      imagePullPolicy: Always
      env:
        - name: BASEURL
          value: "https://sut-nginx-ingress-controller/api"
        - name: AUTHURL
          value: "https://sut-nginx-ingress-controller/oidc"
        - name: INSECURE_CERTS
          value: "true"
        - name: QSEFE_LICENSE
          valueFrom:
            secretKeyRef:
              name: qsefe-license
              key: qsefe-license
      resources:
        requests:
          cpu: "0.5"
          memory: 512Mi
      volumeMounts:
        - mountPath: "/gauge/logs"
          name: platform-test-pvc
          subPath: logs
        - mountPath: "/gauge/reports"
          name: platform-test-pvc
          subPath: reports
  restartPolicy: Never
